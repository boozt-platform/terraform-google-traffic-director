# SPDX-FileCopyrightText: Copyright Boozt Fashion, AB
# SPDX-License-Identifier: MIT
---
remotes:
  - git_url: https://github.com/boozt-platform/lefthook.git
    ref: v1.5.0
    configs:
      # lint commit messages based by the conventional commits
      - hooks/commitlint/.lefthook.yaml
      # check if the license headers are present in the files
      - hooks/license-checker/.lefthook.yaml

# All hooks using binaries (installed via mise)
pre-commit:
  parallel: false
  commands:
    # Terraform
    terraform_fmt:
      glob: "*.tf"
      priority: 1
      tags: [terraform, lint]
      run: task fmt:check

    terraform_validate:
      glob: "*.tf"
      priority: 2
      tags: [terraform, lint]
      run: task validate

    terraform_docs:
      skip:
        - run: test ! -f ".terraform-docs.yml"
      stage_fixed: true
      priority: 3
      tags: [terraform, docs]
      run: task docs

    # Markdown
    markdown-lint:
      glob: "*.md"
      priority: 4
      tags: [markdown, lint]
      run: markdownlint --config .markdownlint.yaml {staged_files}

    # YAML
    yamllint:
      glob: "*.{yaml,yml}"
      priority: 5
      tags: [yaml, lint]
      run: yamllint -c .yamllint.yaml {staged_files}

pre-push:
  commands:
    terraform_test:
      glob: "*.tf"
      tags: [terraform, test]
      run: task test
